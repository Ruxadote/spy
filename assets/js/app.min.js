jQuery((function(){"use strict";var daftplug=jQuery(".daftplug"),header=daftplug.find(".daftplugHeader"),form=daftplug.find(".daftplugForm"),footer=daftplug.find(".daftplugFooter"),client=new ClientJS,isMobile="mobile"==client.getDeviceType(),isAndroidChrome="Android"==client.getOS()&&client.isChrome(),isAndroidFirefox="Android"==client.getOS()&&client.isFirefox(),isAndroidOpera="Android"==client.getOS()&&client.isOpera(),isIosSafari="iOS"==client.getOS()&&client.isSafari(),isFullscreenOverlayShown=getCookie("fullscreenOverlay"),fullscreenOverlay=daftplug.find(".daftplugFullscreenOverlay"),chromeFullscreenOverlay=fullscreenOverlay.filter(".-chrome"),firefoxFullscreenOverlay=fullscreenOverlay.filter(".-firefox"),operaFullscreenOverlay=fullscreenOverlay.filter(".-opera"),safariFullscreenOverlay=fullscreenOverlay.filter(".-safari"),words=["ბათუმი","შოკოლადი","ქუთაისი","საბურთალო","კაზინო","იტალია","ამერიკა","ფეხბურთი","კალათბურთი","ჩხუბი","ირანი","ხინკალი","ვაკე","სავაჭრო ცენტრი","საპირფარეშო","რუსთავი","მაკდონალდსი","სკოლა","მატარებელი","ავტობუსი","თურქეთი","სოფელი","საბილიარდო","აფრიკა","საფრანგეთი","მუსიკა","სოლარიუმი","სილამაზის სალონი","საავადმყოფო","იუსტიციის სახლი","რესტორანი","რუსეთი","ღამის კლუბი","ნარკოტიკი","ალკოჰოლი","უნივერსიტეტი","ევროპა","კახეთი","იმერეთი","სამეგრელო","სვანეთი","რაჭა","აფთიაქი","პლიაჟი","ტაქსი","სააბაზანო","სტადიონი","ბოსტანი","სასაფლაო","ბანკი","ციხე","სასტუმრო","უკრაინა","ინგლისი","თბილისი","ეკლესია","ფიტნეს დარბაზი","ქორწილი","ქელეხი","ომი","დუბაი","ტყე","საგიჟეთი","ლიმონი","ელიავა","თეფში","ტელეფონი","სანთებელა","ფული","შეყვარებული","დასვენება","მანქანა","ჩრდილოეთ კორეა","ფონიჭალა","სიგარეტი","ძილი","ყავა","ცეკვა","სიმღერა","დაბადების დღე","კითხვა","აზერბაიჯანი","წიწიბურა","სნიკერსი","კოკა-კოლა","შაურმა","სიცილი"],word,playerCount,spyCount,time,playersArray=[],timerInterval,touchstartTime,touchTimeout,touchIndex=0;function isPwa(){return["fullscreen","standalone","minimal-ui"].some(displayMode=>window.matchMedia("(display-mode: "+displayMode+")").matches)}function setCookie(name,value,days){var expires="";if(days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toUTCString()}document.cookie=name+"="+(value||"")+expires+"; path=/"}function getCookie(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null}function removeCookie(name){setCookie(name,"",-1)}if(navigator.serviceWorker&&window.addEventListener("load",(function(){navigator.serviceWorker.register("https://daftplug.com/spy/serviceworker.js",{scope:"/spy/"})})),daftplug.find(".daftplugInputSelect").each((function(e){var self=jQuery(this),field=self.find(".daftplugInputSelect_field"),fieldOption=field.find("option"),label=jQuery('label[for="'+field.attr("id")+'"]'),placeholder=field.attr("data-placeholder");field.after(`<div class="daftplugInputSelect_dropdown"></div>\n                     <span class="daftplugInputSelect_placeholder">${placeholder}</span>\n                     <ul class="daftplugInputSelect_list"></ul>\n                     <span class="daftplugInputSelect_arrow"></span>`),fieldOption.each((function(e){self.find(".daftplugInputSelect_list").append(`<li class="daftplugInputSelect_option" data-value="${jQuery(this).val().trim()}">\n                                                                    <a class="daftplugInputSelect_text">${jQuery(this).text().trim()}</a>\n                                                                </li>`)}));var dropdown=self.find(".daftplugInputSelect_dropdown"),list=self.find(".daftplugInputSelect_list"),option=self.find(".daftplugInputSelect_option");dropdown.add(list).attr("data-name",field.attr("name")),field.find("option:selected").length&&(dropdown.attr("data-value",jQuery(this).find("option:selected").val()).text(jQuery(this).find("option:selected").text()).addClass("-hasValue"),list.find('.daftplugInputSelect_option[data-value="'+jQuery(this).find("option:selected").val()+'"]').addClass("-selected")),option.on("click",(function(e){var self=jQuery(this);option.removeClass("-selected"),self.addClass("-selected"),fieldOption.prop("selected",!1),field.find('option[value="'+self.attr("data-value")+'"]').prop("selected",!0),dropdown.text(self.children().text()).addClass("-hasValue")})),dropdown.add(label).on("click",(function(e){daftplug.find(".daftplugInputSelect_dropdown, .daftplugInputSelect_list").not(dropdown).not(list).removeClass("-open"),e.stopPropagation(),e.preventDefault(),dropdown.toggleClass("-open"),list.toggleClass("-open").scrollTop(0)})),jQuery(document).on("click touch",(function(e){dropdown.hasClass("-open")&&(dropdown.toggleClass("-open"),list.removeClass("-open"))})),field.on("invalid",(function(e){self.addClass("-invalid"),setTimeout((function(e){self.removeClass("-invalid")}),2300)}))})),daftplug.find(".daftplugInputRange").each((function(e){var self=jQuery(this),field=self.find(".daftplugInputRange_field"),val=parseFloat(field.val()),min=parseFloat(field.attr("min")),max=parseFloat(field.attr("max"));field.after('<output class="daftplugInputRange_output">'+val+"</output>");var output=self.find(".daftplugInputRange_output");field.on("input change",(function(e){var val=parseFloat(field.val()),fillPercent=100*(val-min)/(max-min);field.css("background","linear-gradient(to right, #ffeba7 0%, #ffeba7 "+fillPercent+"%, #9ba0a9 "+fillPercent+"%)"),output.text(val)})).trigger("change")})),form.on("submit",(function(e){e.preventDefault(),word=words[Math.floor(Math.random()*words.length)],playerCount=parseInt(daftplug.find("#playerCount").val()),spyCount=parseInt(daftplug.find("#spyCount").val()),time=60*parseInt(daftplug.find("#time").val());for(var i=0;i<playerCount;i++)i<spyCount?playersArray.push(1):playersArray.push(0);playersArray.sort(()=>.5-Math.random()),daftplug.find(header).add(form).add(footer).fadeOut(300,(function(t){daftplug.find(".daftplugGame").addClass("-started").find(".daftplugCard").delay(1e3).fadeIn(400)}))})),daftplug.find(".daftplugCard").on("touchstart mousedown",(function(e){e.preventDefault();var d=new Date;touchstartTime=d.getTime(),touchTimeout=setTimeout((function(){daftplug.find(".daftplugCard_wrapper").addClass("-flipped"),1==playersArray[touchIndex]?setTimeout((function(){daftplug.find(".daftplugCardBack_result").hide().html('\n<img class="daftplugCardBack_img" src="assets/img/icon-150.png" alt="logo"/>\n<h2 class="daftplugCardBack_title" style="color: #bf202f;">ჩუმჩუმელა</h2>\n                            <p class="daftplugCardBack_desc" style="color: #c34450;">შენ ხარ ჩუმჩუმელა. არ შეიმჩნიო და ეცადე გაარკვიო რა სიტყვაზე ლაპარაკობენ მოქალაქეები.</p>\n').fadeIn("fast")}),100):setTimeout((function(){daftplug.find(".daftplugCardBack_result").hide().html(`\n<img class="daftplugCardBack_img" src="assets/img/person.png" alt="person"/>\n<h2 class="daftplugCardBack_title">${word}</h2>\n<p class="daftplugCardBack_desc">შენ ხარ მოქალაქე. ეს სიტყვა ერთ-ერთმა მოქალაქემ არ იცის. დასვი კითხვები რათა გაარკვიო რომელი მათგანია ჩუმჩუმელა.</p>\n  `).fadeIn("fast")}),100)}),300)})),daftplug.find(".daftplugCard").on("touchend mouseup",(function(e){if(clearTimeout(touchTimeout),(new Date).getTime()-touchstartTime>300&&(touchIndex++,console.log(touchIndex),daftplug.find(".daftplugCard_wrapper").removeClass("-flipped"),setTimeout((function(){daftplug.find(".daftplugCardBack_result").text("")}),300),touchIndex==playerCount)){daftplug.find(".daftplugCard").css("pointer-events","none"),daftplug.find(".daftplugCardFront_result").hide().html('\n<h1 class="daftplugCardFront_timer"></h1>\n<p class="daftplugCardFront_desc">დაიწყეთ ერთმანეთისთვის კითხვების დასმა! იპოვეთ ჩუმჩუმელა დროის გასვლამდე, სხვა შემთხვევაში ის გაიმარჯვებს.</p>\n').fadeIn("fast");var timerElement=daftplug.find(".daftplugCardFront_timer"),timer=time,minutes,seconds;timerInterval=setInterval((function(){minutes=parseInt(timer/60,10),seconds=parseInt(timer%60,10),minutes=minutes<10?"0"+minutes:minutes,seconds=seconds<10?"0"+seconds:seconds,timerElement.text(minutes+":"+seconds),--timer<0&&(clearInterval(timerInterval),touchIndex=0,playersArray=[],daftplug.find(".daftplugCardBack_result").text(""),daftplug.find(".daftplugCardFront_result").hide().html('<h4 class="daftplugCardFront_timer">დრო გავიდა!</h1>').fadeIn("fast"))}),1e3)}})),daftplug.find(".daftplugButton.-exit").on("click",(function(){daftplug.find(".daftplugGame").removeClass("-started").find(".daftplugCard").fadeOut(400,(function(){clearInterval(timerInterval),touchIndex=0,playersArray=[],daftplug.find(".daftplugCardBack_result").text(""),daftplug.find(".daftplugCard").css("pointer-events","auto"),daftplug.find(header).add(form).add(footer).fadeIn(400),daftplug.find(".daftplugCardFront_result").html('<h3 class="daftplugCardFront_title">დააჭირე და არ აუშვა</h3>')}))})),isMobile&&null==isFullscreenOverlayShown&&fullscreenOverlay.length&&!isPwa()){if(isAndroidChrome&&chromeFullscreenOverlay.length){var isFullscreenOverlayFired=!1,installPromptEvent=void 0;window.addEventListener("beforeinstallprompt",(function(event){event.preventDefault(),installPromptEvent=event,isFullscreenOverlayFired||setTimeout((function(){chromeFullscreenOverlay.fadeIn("fast",(function(e){isFullscreenOverlayFired=!0,chromeFullscreenOverlay.on("click",".daftplugFullscreenOverlay_button",(function(e){chromeFullscreenOverlay.fadeOut("fast",(function(e){setCookie("fullscreenOverlay","shown",2),installPromptEvent.prompt(),installPromptEvent=null}))}))}))}),3e3)}))}else isAndroidFirefox&&firefoxFullscreenOverlay.length?setTimeout((function(){firefoxFullscreenOverlay.fadeIn("fast")}),3e3):isAndroidOpera&&operaFullscreenOverlay.length?setTimeout((function(){operaFullscreenOverlay.fadeIn("fast")}),3e3):isIosSafari&&safariFullscreenOverlay.length&&setTimeout((function(){safariFullscreenOverlay.fadeIn("fast")}),3e3);fullscreenOverlay.on("click",".daftplugFullscreenOverlay_close",(function(e){fullscreenOverlay.fadeOut("fast",(function(e){setCookie("fullscreenOverlay","shown",2)}))}))}}));